# Liars Dice (局域网版)

**项目简介**

- **描述**: `liars-dice-lan` 是一个基于浏览器和 WebSocket 的局域网版吹牛子弹（变体）游戏。服务器用 `Node.js` + `Express` + `socket.io` 实现，客户端静态文件位于 `public/`。
- **用途**: 在同一局域网内的多台设备上即时对战，支持发牌、质疑、轮盘惩罚等游戏逻辑。

**目录结构（主要文件）**

- `server.js`: 游戏服务器，监听默认端口 `3002`，并通过 `internal-ip` 打印局域网地址。
- `ai-player.js`: AI 玩家决策模块，支持简单/中等/困难三种难度。
- `package.json`: 依赖与脚本。
- `public/`: 前端静态资源（`index.html`, `script.js`, `style.css` 等）。
- `public/assets/`: 资源文件目录。

**依赖**

- Node.js (建议 v16+)
- `express`, `socket.io`, `internal-ip` 等（见 `package.json`）

**快速安装与运行**

1. 安装依赖：

```pwsh
npm install
```

2. 启动服务器：

```pwsh
npm run start
```

启动后服务器会打印两条常用地址：本地访问 `http://localhost:3002` 和 局域网访问 `http://<本机局域网IP>:3002`。

**在局域网中加入游戏**

- 确保服务器所在主机与要加入的设备在同一子网（同一 Wi‑Fi 或同一有线网段）。
- 防火墙允许程序监听的端口（默认 `3002`）。
- 在其他设备的浏览器中打开服务器打印的局域网地址（例如 `http://192.168.1.5:3002`），输入昵称加入大厅。

**AI 玩家功能**

- **单人游戏**: 如果只有一个玩家，房主可以添加 AI 玩家进行单人游戏。
- **添加 AI**: 房主在大厅中可以选择 AI 难度（简单/中等/困难），然后点击"添加 AI 玩家"按钮。
- **移除 AI**: 房主可以点击"移除 AI 玩家"按钮移除最后添加的 AI。
- **AI 难度说明**:
  - **简单**: 随机出牌，低概率质疑（20%）
  - **中等**: 优先出真牌，根据出牌数量决定是否质疑
  - **困难**: 策略性出牌，根据概率计算决定质疑，会使用"王的审判"
- **玩家上限**: 最多支持 7 个玩家（包括真人和 AI）。

**重要实现细节（开发者）**

- 主要 socket 事件：`join`, `startGame`, `playCards`, `challenge`, `pullTrigger`, `triggerAd`。
- 服务器端口固定为 `3002`（如需更改，请编辑 `server.js` 中的 `PORT` 变量）。
- 局域网地址由 `internal-ip` 获取并打印，便于其他设备连接。

**常见问题与排查**

- 如果其他设备无法访问：检查服务器主机的防火墙或路由器设置，确保 `3002` 端口对局域网开放。
- 确认服务器已成功打印局域网地址并显示 `Listening` 信息。
- 如果客户端刷新后出现异常，尝试清除浏览器缓存或在无痕窗口打开。

**开发与贡献**

- 欢迎提交 issue 或 PR 来修复 bug、优化玩法或改进 UI。
- 提交代码前请确保本地能正常运行并保持变更最小、清晰。
